module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=26)}([function(e,t){e.exports=flarum.core.compat.app},function(e,t){e.exports=flarum.core.compat.Model},function(e,t,n){"use strict";function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.d(t,"a",(function(){return r}))},function(e,t){e.exports=flarum.core.compat.extend},function(e,t){e.exports=flarum.core.compat["components/Button"]},function(e,t,n){"use strict";t.a=function(e,t){return void 0===t&&(t="sort"),e.sort((function(e,n){return e[t]()-n[t]()}))}},function(e,t){e.exports=flarum.core.compat.Component},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),o=n(1),i=n.n(o),a=n(8),s=n.n(a),l=n(9),c=n.n(l),u=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.apiEndpoint=function(){return"/fof/terms/policies"+(this.exists?"/"+this.data.id:"")},t}(s()(i.a,{sort:i.a.attribute("sort"),name:i.a.attribute("name"),url:i.a.attribute("url"),update_message:i.a.attribute("update_message"),terms_updated_at:i.a.attribute("terms_updated_at"),form_key:c()("id",(function(e){return"fof_terms_policy_"+e}))}))},function(e,t){e.exports=flarum.core.compat["utils/mixin"]},function(e,t){e.exports=flarum.core.compat["utils/computed"]},,,,,,,,,,,function(e,t){e.exports=flarum.core.compat["components/SettingsModal"]},function(e,t){e.exports=flarum.core.compat["components/Switch"]},function(e,t){e.exports=flarum.core.compat["helpers/icon"]},function(e,t){e.exports=flarum.core.compat["utils/extractText"]},function(e,t){e.exports=flarum.core.compat["components/PermissionGrid"]},,function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(7),a=n(2),s=n(20),l=n.n(s),c=n(21),u=n.n(c);function f(e,t,n){if(void 0===n)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=n}var p=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter((function(e){return 1===e.nodeType&&e.matches(t)}))},d=new Map,h=function(){function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(e.prototype,"config",{get:function(){var e={};return this._config.forEach((function(t,n){e[n]=t})),e},set:function(e){if("object"!=typeof e)throw new Error("You must provide a valid configuration object to the config setter.");var t=Object.assign({},e);this._config=new Map(Object.entries(t))},enumerable:!0,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw new Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw new Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw new Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!0,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw new Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.delete(e)},e}(),g=function(e){if(!(e instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return d.has(e)||d.set(e,new h),d.get(e)};function v(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)v(e[r],t,n);else e.addEventListener(t,n),g(e).setData("event"+t,n)}function y(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)y(e[n],t);else e.removeEventListener(t,g(e).getData("event"+t)),g(e).deleteData("event"+t)}function b(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)b(e[r],t,n);else e.setAttribute(t,n)}function w(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)w(e[n],t);else e.removeAttribute(t)}var E=function(e){if(!e.parentElement||0===e.getClientRects().length)throw new Error("target element must be part of the dom");var t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}},x=function(e,t){if(!(e instanceof HTMLElement&&(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},T=function(e){if(!(e instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==e.parentNode},_=function(e,t,n){if(!(e instanceof HTMLElement&&e.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===n?e:e.nextElementSibling)},F=function(e,t){return _(e,t,"after")},C=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["height","padding-top","padding-bottom"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},L=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},M=function(e,t){if(!(e instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter((function(e){return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement})).map((function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)}))},S=function(e){return e.composedPath&&e.composedPath()[0]||e.target},A=function(e,t,n){return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}},O=function(e,t){if(!0===e.isSortable){var n=g(e).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter((function(e){return e.length>0&&t.matches(e)})).length>0;if(e===t)return!0;if(void 0!==g(e).getConfig("connectWith")&&null!==g(e).getConfig("connectWith"))return g(e).getConfig("connectWith")===g(t).getConfig("connectWith")}return!1},P={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};var j,D,H,I,Y,B,N,k,z,W=function(e,t){if("string"==typeof g(e).getConfig("hoverClass")){var n=g(e).getConfig("hoverClass").split(" ");!0===t?(v(e,"mousemove",function(e,t){var n=this;if(void 0===t&&(t=250),"function"!=typeof e)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof t)throw new Error("You must provide a number as the second argument for throttle.");var r=null;return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var a=Date.now();(null===r||a-r>=t)&&(r=a,e.apply(n,o))}}((function(t){0===t.buttons&&p(e.children,g(e).getConfig("items")).forEach((function(e){var r,o;e!==t.target?(r=e.classList).remove.apply(r,n):(o=e.classList).add.apply(o,n)}))}),g(e).getConfig("throttleTime"))),v(e,"mouseleave",(function(){p(e.children,g(e).getConfig("items")).forEach((function(e){var t;(t=e.classList).remove.apply(t,n)}))}))):(y(e,"mousemove"),y(e,"mouseleave"))}},q=function(e){y(e,"dragstart"),y(e,"dragend"),y(e,"dragover"),y(e,"dragenter"),y(e,"drop"),y(e,"mouseenter"),y(e,"mouseleave")},R=function(e){var t;(t=e).h5s&&delete t.h5s.data,w(e,"aria-dropeffect")},U=function(e){w(e,"aria-grabbed"),w(e,"aria-copied"),w(e,"draggable"),w(e,"role")};function X(e,t){if(t.composedPath)return t.composedPath().find((function(e){return e.isSortable}));for(;!0!==e.isSortable;)e=e.parentElement;return e}function G(e,t){var n=f(e,"opts"),r=p(e.children,n.items).filter((function(e){return e.contains(t)||e.shadowRoot&&e.shadowRoot.contains(t)}));return r.length>0?r[0]:t}var V=function(e){var t=f(e,"opts"),n=p(e.children,t.items),r=M(n,t.handle);(b(e,"aria-dropeffect","move"),f(e,"_disabled","false"),b(r,"draggable","true"),!1===t.disableIEFix)&&("function"==typeof(document||window.document).createElement("span").dragDrop&&v(r,"mousedown",(function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===n.indexOf(e);)e=e.parentElement;e.dragDrop()}})))};function J(e,t){var n=String(t);return t=t||{},"string"==typeof e&&(e=document.querySelectorAll(e)),e instanceof HTMLElement&&(e=[e]),e=Array.prototype.slice.call(e),/serialize/.test(n)?e.map((function(e){var t=f(e,"opts");return function(e,t,n){if(void 0===t&&(t=function(e,t){return e}),void 0===n&&(n=function(e){return e}),!(e instanceof HTMLElement)||!0==!e.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof t||"function"!=typeof n)throw new Error("You need to provide a valid serializer for items and the container.");var r=f(e,"opts").items,o=p(e.children,r),i=o.map((function(t){return{parent:e,node:t,html:t.outerHTML,index:x(t,o)}}));return{container:n({node:e,itemCount:i.length}),items:i.map((function(n){return t(n,e)}))}}(e,t.itemSerializer,t.containerSerializer)})):(e.forEach((function(e){if(/enable|disable|destroy/.test(n))return J[n](e);["connectWith","disableIEFix"].forEach((function(e){Object.prototype.hasOwnProperty.call(t,e)&&null!==t[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')})),t=Object.assign({},P,g(e).config,t),g(e).config=t,f(e,"opts",t),e.isSortable=!0,function(e){var t=f(e,"opts"),n=p(e.children,t.items),r=M(n,t.handle);f(e,"_disabled","false"),q(n),y(r,"mousedown"),y(e,"dragover"),y(e,"dragenter"),y(e,"drop")}(e);var r,o=p(e.children,t.items);if(null!==t.placeholder&&void 0!==t.placeholder){var i=document.createElement(e.tagName);t.placeholder instanceof HTMLElement?i.appendChild(t.placeholder):i.innerHTML=t.placeholder,r=i.children[0]}g(e).placeholder=function(e,t,n){var r;if(void 0===n&&(n="sortable-placeholder"),!(e instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr")).innerHTML='<td colspan="100"></td>':t=document.createElement("div")),"string"==typeof n&&(r=t.classList).add.apply(r,n.split(" ")),t}(e,r,t.placeholderClass),f(e,"items",t.items),t.acceptFrom?f(e,"acceptFrom",t.acceptFrom):t.connectWith&&f(e,"connectWith",t.connectWith),V(e),b(o,"role","option"),b(o,"aria-grabbed","false"),W(e,!0),v(e,"dragstart",(function(e){var n=S(e);if(!0!==n.isSortable&&(e.stopImmediatePropagation(),(!t.handle||n.matches(t.handle))&&"false"!==n.getAttribute("draggable"))){var r=X(n,e),o=G(r,n);N=p(r.children,t.items),Y=N.indexOf(o),B=x(o,r.children),I=r,function(e,t,n){if(!(e instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=A),e.dataTransfer&&e.dataTransfer.setDragImage){var r=n(t,E(t),e);if(!(r.element instanceof HTMLElement)||"number"!=typeof r.posX||"number"!=typeof r.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",S(e).id),e.dataTransfer.setDragImage(r.element,r.posX,r.posY)}}(e,o,t.customDragImage),D=C(o),H=L(o),o.classList.add(t.draggingClass),j=function(e,t){var n=e;return!0===g(t).getConfig("copy")&&(b(n=e.cloneNode(!0),"aria-copied","true"),e.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=e.style.display),n}(o,r),b(j,"aria-grabbed","true"),r.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:B,index:Y,container:I},item:j,originalTarget:n}}))}})),v(e,"dragenter",(function(t){var n=S(t),r=X(n,t);r&&r!==k&&(z=p(r.children,f(r,"items")).filter((function(t){return t!==g(e).placeholder})),r.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:B,index:Y,container:I},destination:{container:r,itemsBeforeUpdate:z},item:j,originalTarget:n}}))),k=r})),v(e,"dragend",(function(n){if(j){j.classList.remove(t.draggingClass),b(j,"aria-grabbed","false"),"true"===j.getAttribute("aria-copied")&&"true"!==f(j,"dropped")&&j.remove(),j.style.display=j.oldDisplay,delete j.oldDisplay;var r=Array.from(d.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(T)[0];r&&r.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:B,index:Y,container:I},item:j}})),k=null,j=null,D=null,H=null}})),v(e,"drop",(function(n){if(O(e,j.parentElement)){n.preventDefault(),n.stopPropagation(),f(j,"dropped","true");var r=Array.from(d.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(T)[0];F(r,j),r.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:B,index:Y,container:I},item:j}}));var o=g(e).placeholder,i=p(I.children,t.items).filter((function(e){return e!==o})),a=!0===this.isSortable?this:this.parentElement,s=p(a.children,f(a,"items")).filter((function(e){return e!==o})),l=x(j,Array.from(j.parentElement.children).filter((function(e){return e!==o}))),c=x(j,s);B===l&&I===a||e.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:B,index:Y,container:I,itemsBeforeUpdate:N,items:i},destination:{index:c,elementIndex:l,container:a,itemsBeforeUpdate:z,items:s},item:j}}))}}));var a,s,l,c=(a=function(e,n,r,o){if(j)if(t.forcePlaceholderSize&&(g(e).placeholder.style.height=D+"px",g(e).placeholder.style.width=H+"px"),Array.from(e.children).indexOf(n)>-1){var i=C(n),a=L(n),s=x(g(e).placeholder,n.parentElement.children),l=x(n,n.parentElement.children);if(i>D||a>H){var c=i-D,u=a-H,f=E(n).top,m=E(n).left;if(s<l&&("vertical"===t.orientation&&o<f||"horizontal"===t.orientation&&r<m))return;if(s>l&&("vertical"===t.orientation&&o>f+i-c||"horizontal"===t.orientation&&r>m+a-u))return}void 0===j.oldDisplay&&(j.oldDisplay=j.style.display),"none"!==j.style.display&&(j.style.display="none");var h=!1;try{var v=E(n).top+n.offsetHeight/2,y=E(n).left+n.offsetWidth/2;h="vertical"===t.orientation&&o>=v||"horizontal"===t.orientation&&r>=y}catch(e){h=s<l}h?F(n,g(e).placeholder):function(e,t){_(e,t,"before")}(n,g(e).placeholder),Array.from(d.values()).filter((function(e){return void 0!==e.placeholder})).forEach((function(t){t.placeholder!==g(e).placeholder&&t.placeholder.remove()}))}else{var b=Array.from(d.values()).filter((function(e){return void 0!==e.placeholder})).map((function(e){return e.placeholder}));-1!==b.indexOf(n)||e!==n||p(n.children,t.items).length||(b.forEach((function(e){return e.remove()})),n.appendChild(g(e).placeholder))}},void 0===(s=t.debounce)&&(s=0),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(l),l=setTimeout((function(){a.apply(void 0,e)}),s)}),u=function(e){var t=e.target,n=!0===t.isSortable?t:X(t,e);if(t=G(n,t),j&&O(n,j.parentElement)&&"true"!==f(n,"_disabled")){var r=f(n,"opts");parseInt(r.maxItems)&&p(n.children,f(n,"items")).length>=parseInt(r.maxItems)&&j.parentElement!==n||(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect=!0===g(n).getConfig("copy")?"copy":"move",c(n,t,e.pageX,e.pageY))}};v(o.concat(e),"dragover",u),v(o.concat(e),"dragenter",u)})),e)}J.destroy=function(e){!function(e){var t=f(e,"opts")||{},n=p(e.children,t.items),r=M(n,t.handle);y(e,"dragover"),y(e,"dragenter"),y(e,"dragstart"),y(e,"dragend"),y(e,"drop"),R(e),y(r,"mousedown"),q(n),U(n),e.isSortable=!1}(e)},J.enable=function(e){V(e)},J.disable=function(e){!function(e){var t=f(e,"opts"),n=p(e.children,t.items),r=M(n,t.handle);b(e,"aria-dropeffect","none"),f(e,"_disabled","true"),b(r,"draggable","false"),y(r,"mousedown")}(e)},J.__testing={_data:f,_removeItemEvents:q,_removeItemData:U,_removeSortableData:R};var K=J,Q=n(6),Z=n.n(Q),ee=n(22),te=n.n(ee),ne=n(23),re=n.n(ne),oe=n(4),ie=n.n(oe),ae=function(e){function t(){return e.apply(this,arguments)||this}Object(a.a)(t,e);var n=t.prototype;return n.init=function(){this.policy=this.props.policy,this.dirty=!1,this.processing=!1,this.toggleFields=!1,null===this.policy&&this.initNewField()},n.initNewField=function(){this.policy=o.a.store.createRecord("fof-terms-policies",{attributes:{name:"",url:"",update_message:"",terms_updated_at:""}})},n.boxTitle=function(){return this.policy.exists?this.policy.name():o.a.translator.trans("fof-terms.admin.buttons.new-policy")},n.view=function(){var e=this;return m(".FoF-Terms-Policiy-Box",[this.policy.exists?m("span.fas.fa-arrows-alt.FoF-Terms-Policiy-Box--handle.js-policy-handle"):null,m(".Button.Button--block.FoF-Terms-Policiy-Header",{onclick:function(){e.toggleFields=!e.toggleFields}},[m(".FoF-Terms-Policiy-Header-Title",this.boxTitle()),m("div",[this.policy.exists?[o.a.translator.trans("fof-terms.admin.buttons.edit-policy")," "]:null,te()(this.toggleFields?"fas fa-chevron-up":"fas fa-chevron-down")])]),this.toggleFields?this.viewFields():null])},n.viewFields=function(){var e=this;return m("form.FoF-Terms-Policiy-Body",[m(".Form-group",[m("label",o.a.translator.trans("fof-terms.admin.policies.name")),m("input.FormControl",{type:"text",value:this.policy.name(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"name"))}),m(".helpText",o.a.translator.trans("fof-terms.admin.policies.name-help"))]),m(".Form-group",[m("label",o.a.translator.trans("fof-terms.admin.policies.url")),m("input.FormControl",{type:"url",value:this.policy.url(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"url"))}),m(".helpText",o.a.translator.trans("fof-terms.admin.policies.url-help"))]),m(".Form-group",[m("label",o.a.translator.trans("fof-terms.admin.policies.update-message")),m("textarea.FormControl",{value:this.policy.update_message(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"update_message"))}),m(".helpText",o.a.translator.trans("fof-terms.admin.policies.update-message-help"))]),m(".Form-group",[m("label",o.a.translator.trans("fof-terms.admin.policies.terms-updated-at")),m(".FoF-Terms-Input-Group",[m("input.FormControl",{type:"text",value:this.policy.terms_updated_at(),oninput:m.withAttr("value",this.updateAttribute.bind(this,"terms_updated_at")),placeholder:o.a.translator.trans("fof-terms.admin.policies.terms-updated-at-placeholder")}),ie.a.component({className:"Button Button--primary",onclick:function(){e.updateAttribute("terms_updated_at",moment().milliseconds(0).toISOString())},children:o.a.translator.trans("fof-terms.admin.buttons.set-to-now")})]),m(".helpText",o.a.translator.trans("fof-terms.admin.policies.terms-updated-at-help"))]),this.policy.exists?m(".Form-group",[m("label",o.a.translator.trans("fof-terms.admin.policies.export-url")),m(".ButtonGroup",["json","csv"].map((function(t){return m("a.Button.FoF-Terms-Export-Button",{href:o.a.forum.attribute("apiUrl")+"/fof/terms/policies/"+e.policy.id()+"/export."+t,target:"_blank"},t.toUpperCase())}))),m(".helpText",o.a.translator.trans("fof-terms.admin.policies.export-url-help",{a:m("a",{href:"https://github.com/FriendsOfFlarum/terms/wiki/Export-url",target:"_blank"})}))]):null,m(".ButtonGroup",[ie.a.component({type:"submit",className:"Button Button--primary",children:o.a.translator.trans("fof-terms.admin.buttons."+(this.policy.exists?"save":"add")+"-policy"),loading:this.processing,disabled:!this.readyToSave(),onclick:this.savePolicy.bind(this)}),this.policy.exists?ie.a.component({type:"submit",className:"Button Button--danger",children:o.a.translator.trans("fof-terms.admin.buttons.delete-policy"),loading:this.processing,onclick:this.deletePolicy.bind(this)}):""])])},n.updateAttribute=function(e,t){var n;this.policy.pushAttributes(((n={})[e]=t,n)),this.dirty=!0},n.readyToSave=function(){return this.dirty},n.savePolicy=function(){var e=this;this.processing=!0;var t=!this.policy.exists;this.policy.save(this.policy.data.attributes).then((function(){t&&(e.initNewField(),e.toggleFields=!1),e.processing=!1,e.dirty=!1,m.redraw()})).catch((function(t){throw e.processing=!1,t}))},n.deletePolicy=function(){var e=this;confirm(re()(o.a.translator.trans("fof-terms.admin.messages.delete-policy-confirmation",{name:this.policy.name()})))&&(this.processing=!0,this.policy.delete().then((function(){e.processing=!1,m.redraw()})).catch((function(t){throw e.processing=!1,t})))},t}(Z.a),se=n(5),le=function(e){function t(){return e.apply(this,arguments)||this}Object(a.a)(t,e);var n=t.prototype;return n.init=function(){o.a.request({method:"GET",url:o.a.forum.attribute("apiUrl")+"/fof/terms/policies"}).then((function(e){o.a.store.pushPayload(e),m.redraw()}))},n.config=function(){var e=this;K($.find(".js-policies-container")[0],{handle:".js-policy-handle"})[0].addEventListener("sortupdate",(function(){var t=e.$(".js-policy-data").map((function(){return $(this).data("id")})).get();e.updateSort(t)}))},n.view=function(){var e=o.a.store.all("fof-terms-policies"),t=[];return Object(se.a)(e).forEach((function(e){t.push(m(".js-policy-data",{key:e.id(),"data-id":e.id()},ae.component({policy:e})))})),m("div",[m("h2",o.a.translator.trans("fof-terms.admin.titles.policies")),m(".FoF-Terms-Policies-Container",[m(".js-policies-container",t),ae.component({key:"new",policy:null})])])},n.updateSort=function(e){o.a.request({method:"POST",url:o.a.forum.attribute("apiUrl")+"/fof/terms/policies/order",data:{sort:e}}).then((function(e){o.a.store.pushPayload(e),m.redraw()}))},t}(Z.a),ce="fof-terms.admin.settings.",ue=function(e){function t(){return e.apply(this,arguments)||this}Object(a.a)(t,e);var n=t.prototype;return n.title=function(){return o.a.translator.trans(ce+"title")},n.form=function(){return[m(".Form-group",[m("label",o.a.translator.trans(ce+"field.signup-legal-text")),m("textarea.FormControl",{bidi:this.setting("fof-terms.signup-legal-text")})]),m(".Form-group",[m("label",u.a.component({state:this.setting("fof-terms.hide-updated-at")()>0,onchange:this.setting("fof-terms.hide-updated-at"),children:o.a.translator.trans(ce+"field.hide-updated-at")}))]),m(".Form-group",[m("label",o.a.translator.trans(ce+"field.date-format")),m("input[type=text].FormControl",{bidi:this.setting("fof-terms.date-format"),placeholder:"YYYY-MM-DD"}),m(".helpText",o.a.translator.trans(ce+"field.date-format-help",{a:m("a",{href:"https://momentjs.com/docs/#/displaying/format/",target:"_blank"})}))]),le.component()]},t}(l.a),fe=n(3),pe=n(24),de=n.n(pe);o.a.initializers.add("fof-terms",(function(e){e.store.models["fof-terms-policies"]=i.a,e.extensionSettings["fof-terms"]=function(){return e.modal.show(new ue)},Object(fe.extend)(de.a.prototype,"moderateItems",(function(e){e.add("fof-terms-see-user-policies-state",{icon:"fas fa-paperclip",label:o.a.translator.trans("fof-terms.admin.permissions.see-user-policies-state"),permission:"fof-terms.see-user-policies-state"}),e.add("fof-terms-postpone-policies-accept",{icon:"fas fa-paperclip",label:o.a.translator.trans("fof-terms.admin.permissions.postpone-policies-accept"),permission:"fof-terms.postpone-policies-accept"}),e.add("fof-terms-export-policies",{icon:"fas fa-paperclip",label:o.a.translator.trans("fof-terms.admin.permissions.export-policies"),permission:"fof-terms.export-policies"})}))}))}]);
//# sourceMappingURL=admin.js.map